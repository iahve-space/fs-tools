<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fs_tools: fs_tools</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">fs_tools
   </div>
   <div id="projectbrief">C++17 posix library for sysfs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">fs_tools </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <a href="https://github.com/iahve-space/fs-tools/releases"><img src="https://img.shields.io/github/v/release/iahve-space/fs-tools?include_prereleases&amp;label=release" alt="Release" class="inline"/></a> <img src="coverage.svg" alt="" style="pointer-events: none;" class="inline" title="Coverage"/>     [<img src="https://img.shields.io/github/license/iahve-space/protolib" alt="License" class="inline"/>](LICENSE) <a href="https://iahve-space.github.io/protolib/"><img src="https://github.com/iahve-space/fs-tools/actions/workflows/docs.yml/badge.svg" alt="Docs" style="pointer-events: none;" class="inline"/></a></p>
<p><b>fs_tools</b> is a cross-platform C++17 library that provides a set of POSIX helpers for working with the filesystem and the <b>sysfs</b> subsystem on Linux. It simplifies access to devices, directories, and symlinks without using <code>&lt;filesystem&gt;</code> and includes the <b>SysFSHelper</b> class for discovering and analyzing USB devices via sysfs.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md47"></a>
üöÄ Features</h1>
<ul>
<li>üìÇ Working with POSIX filesystem (existence checks, listing, symlinks)</li>
<li>üîç Scanning <b>sysfs</b> to find USB devices and their VID/PID</li>
<li>üß≠ Determining which physical device corresponds to <code>/dev/...</code></li>
<li>‚öôÔ∏è Does not require root privileges</li>
<li>üß± Fully header-only implementation</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md49"></a>
üß© Structure</h1>
<p>The library consists of two main parts:</p>
<ol type="1">
<li><b>fs_tools.hpp</b> ‚Äî basic POSIX helpers (an alternative to <code>&lt;filesystem&gt;</code> for older systems)</li>
<li><b>SysFSHelper.hpp</b> ‚Äî a class for analyzing the <code>/sys</code> structure and mapping USB devices to their device nodes.</li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md51"></a>
üß† How SysFSHelper Works</h1>
<p>The <code>SysFSHelper</code> class uses the virtual filesystem <b>sysfs</b> (<code>/sys</code>) to establish a connection between <code>/dev/...</code> and physical devices.</p>
<p>Example chain for <code>/dev/ttyUSB0</code>:</p>
<div class="fragment"><div class="line">/dev/ttyUSB0</div>
<div class="line">  ‚Üì</div>
<div class="line">/sys/class/tty/ttyUSB0 ‚Üí ../../devices/pci0000:00/.../usb1/1-1/1-1.1/1-1.1:1.0/ttyUSB0</div>
<div class="line">  ‚Üì</div>
<div class="line">/sys/bus/usb/devices/1-1/uevent  ‚Üí  PRODUCT=1a86/7523/2600</div>
</div><!-- fragment --><p>The library traverses up the sysfs tree until it finds an ancestor with <code>PRODUCT=vid/pid/...</code> and returns the pair <code>1a86:7523</code>.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md53"></a>
üíª Usage Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;SysFSHelper.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">auto</span> functions = SysFSHelper::list_functions();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;f : functions) {</div>
<div class="line">        std::cout &lt;&lt; f.m_dev_path &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span></div>
<div class="line">                  &lt;&lt; f.m_vid &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; f.m_pid</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; f.m_class_name &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Example output:</p>
<div class="fragment"><div class="line">/dev/ttyUSB0 -&gt; 1a86:7523 (tty)</div>
<div class="line">/dev/hidraw0 -&gt; 046d:c534 (hidraw)</div>
<div class="line">/dev/video0  -&gt; 05a3:9331 (video4linux)</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md55"></a>
üì¶ Installation</h1>
<h2><a class="anchor" id="autotoc_md56"></a>
CMake + FetchContent</h2>
<div class="fragment"><div class="line">include(FetchContent)</div>
<div class="line">FetchContent_Declare(</div>
<div class="line">        fs_tools</div>
<div class="line">        QUIET</div>
<div class="line">        GIT_REPOSITORY https://github.com/iahve-space/fs-tools.git</div>
<div class="line">        GIT_TAG v1.0.11</div>
<div class="line">)</div>
<div class="line">FetchContent_MakeAvailable(fs_tools)</div>
<div class="line"> </div>
<div class="line">target_link_libraries(your_target PRIVATE fs_tools)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md57"></a>
Conan</h2>
<div class="fragment"><div class="line">conan install fs_tools/[&gt;=1.0.0]@</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md59"></a>
üìö Main API</h1>
<h2><a class="anchor" id="autotoc_md60"></a>
Class &lt;tt&gt;SysFSHelper&lt;/tt&gt;</h2>
<h3><a class="anchor" id="autotoc_md61"></a>
&lt;tt&gt;list_functions()&lt;/tt&gt;</h3>
<p>Returns a list of all USB functions found on the system.</p>
<h3><a class="anchor" id="autotoc_md62"></a>
&lt;tt&gt;find(const std::string &amp;dev)&lt;/tt&gt;</h3>
<p>Returns information about a specific <code>/dev/...</code> node.</p>
<h3><a class="anchor" id="autotoc_md63"></a>
&lt;tt&gt;find_by_id(const std::string &amp;vid, const std::string &amp;pid)&lt;/tt&gt;</h3>
<p>Finds all devices with the specified VID/PID.</p>
<h3><a class="anchor" id="autotoc_md64"></a>
&lt;tt&gt;list_ids()&lt;/tt&gt;</h3>
<p>Returns all unique <code>(VID, PID)</code> pairs of found USB devices.</p>
<h3><a class="anchor" id="autotoc_md65"></a>
&lt;tt&gt;UsbFunction&lt;/tt&gt;</h3>
<p>Structure describing a found device:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>UsbFunction {</div>
<div class="line">    std::string m_vid;        <span class="comment">// Vendor ID (VID)</span></div>
<div class="line">    std::string m_pid;        <span class="comment">// Product ID (PID)</span></div>
<div class="line">    std::string m_usbNode;    <span class="comment">// Path in /sys/bus/usb/devices</span></div>
<div class="line">    std::string m_class_name; <span class="comment">// Subsystem (tty, sound, hidraw...)</span></div>
<div class="line">    std::string m_dev_name;   <span class="comment">// Device name (DEVNAME)</span></div>
<div class="line">    std::string m_dev_path;   <span class="comment">// Full path /dev/...</span></div>
<div class="line">};</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md67"></a>
üìò fs_tools Module</h1>
<p><code>fs_tools</code> is a helper part of the library implementing basic POSIX filesystem functions without <code>&lt;filesystem&gt;</code>.</p>
<h2><a class="anchor" id="autotoc_md68"></a>
Main functions:</h2>
<ul>
<li><code>path_exists(path)</code> ‚Äî check existence</li>
<li><code>is_dir(path)</code> ‚Äî check if it's a directory</li>
<li><code>is_symlink(path)</code> ‚Äî check if the path is a symlink</li>
<li><code>is_reg(path)</code> ‚Äî check if the path is a regular file</li>
<li><code>join_path(head, tail)</code> ‚Äî join paths</li>
<li><code>dir_name(path)</code> ‚Äî extract directory from path</li>
<li><code>list_dirs(dir)</code> / <code>list_dir_fs(dir, pattern)</code> ‚Äî directory listing</li>
<li><code>readlink_once(path)</code> ‚Äî read symlink target</li>
<li><code>make_dir_once(path)</code> ‚Äî create directory (like <code>mkdir -p</code>)</li>
</ul>
<h2><a class="anchor" id="autotoc_md69"></a>
Usage example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;fs_tools.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span>fs_tools;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keywordflow">if</span> (!path_exists(<span class="stringliteral">&quot;/sys&quot;</span>)) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;/sys not found&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;p : list_dirs(<span class="stringliteral">&quot;/sys/class/tty&quot;</span>)) {</div>
<div class="line">        std::cout &lt;&lt; p &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md71"></a>
üß© Requirements</h1>
<ul>
<li>Linux with <b>sysfs</b> support (<code>/sys</code>)</li>
<li>C++17 or higher</li>
<li>No external dependencies</li>
</ul>
<hr  />
 </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
